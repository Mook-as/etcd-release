---
director_uuid: (( merge ))

stub: (( merge ))

etcd_releases:
  - name: (( stub.releases.etcd.name || "etcd" ))
    version: (( stub.releases.etcd.version || "latest" ))

networks: (( merge ))

default_templates:
  etcd:
    - name: etcd
      release: (( stub.releases.etcd.name ))

etcd_jobs:
- name: etcd_z1
  templates: (( stub.jobs.etcd_z1.templates || default_templates.etcd ))
  instances: (( stub.jobs.etcd_z1.instances || 1 ))
  persistent_disk: 10240
  resource_pool: medium_z1
  networks:
    - name: (( stubs.jobs.etcd_z1.networks.name || "etcd1" ))
      static_ips: (( stub.jobs.etcd_z1.networks.static_ips || static_ips(0, 1) ))
  properties:
    networks:
      - name: etcd1
    metron_agent:
      zone: z1
  update:
    max_in_flight: 1

- name: etcd_z2
  templates: (( stub.jobs.etcd_z2.templates || default_templates.etcd ))
  instances: (( stub.jobs.etcd_z2.instances || 2 ))
  persistent_disk: 10240
  resource_pool: medium_z2
  networks:
    - name: (( stubs.jobs.etcd_z2.networks.name || "etcd2" ))
      static_ips: (( stub.jobs.etcd_z2.networks.static_ips || static_ips(0, 1) ))
  properties:
    networks:
      - name: etcd2
    metron_agent:
      zone: z2
  update:
    max_in_flight: 1

properties:
  <<: (( merge ))

  etcd:
    ca_cert: null
    client_cert: null
    client_key: null
    cluster: null
    peer_require_ssl: null
    require_ssl: null
    server_cert: null
    server_key: null
    machines: (( etcd_jobs.etcd_z1.networks.etcd1.static_ips etcd_jobs.etcd_z2.networks.etcd2.static_ips ))
